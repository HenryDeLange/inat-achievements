<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>iNaturalist Achievements</title>
        <!--ReactJS-->
        <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
        <!--Bootstrap-->
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
        <!--Icons-->
        <link rel="stylesheet" href="./icons/style.css">
    </head>
    <body>
<!--TODO: Kry 'n mooier header component wat verduidelik wat aangaan-->
        <div class="row">
            <div class="col">
                <hr />
                <H2 style="text-align: center; color: #2ca351">
                    Achievements
                </H2>
                <hr />
            </div>
        </div>
<!--NOTE: When using React JSX, within the <script> tags, for regular HTML tags, 
    the attribute className is used instead of class and the attribute htmlFor is used instead 
    of for attribute because these are reserved words in Javascript.-->
<!--NOTE: Inline styles are dodgy to use and the class attribute needs to be renamed to className-->        
<!--NOTE: Reusable components (can be done in different way using classes as well)-->


<!--TODO: Bou die achievements lys in die kode-->


        
        <div id="demo"></div>
        <hr />
        <div id="achievementList"></div>
        <script type="text/babel">
            // Declare the AchievementCard
            function AchievementCard(props) {
                var cardHTML =
                    <div className="col-6 col-sm-4 col-md-3 col-lg-2">
                        <div className="card text-center border-0" style={{"margin": "2rem"}}>
                            <span className="icon-drawing1" style={{"color": "#Bcb371", "fontSize": "6rem"}} ></span>
                            <div className="card-text">{props.title}</div>
                        </div>
                    </div>
                return cardHTML;
            }
            // Load the data
// TODO: Handle pagination
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    var response = this.responseText;
                    // Process data
                    var data = JSON.parse(response);
                    var arrayLength = data.results.length;
                    // Calculate the Achievements
                    var speciesCount = 0;
                    var selfCommentCount = 0;
                    for (var i = 0; i < arrayLength; i++) {
                        var result = data.results[i];
                        // Species Count
                        if (result.taxon.rank_level <= 10) {
                            speciesCount++;
                        }
                        // Comments of yourself on your own observervation
                        for (var c = 0; c < result.comments_count; c++) {
                            var comment = result.comments[c];
                            if (comment.user.id === result.user.id) {
                                selfCommentCount++;
                            }
                        }
                    }
                    // Show the Achievements
                    ReactDOM.render(
                            <div className="container">
                                <div className="row">
                                    <AchievementCard title={"Life Lister " + speciesCount} />
                                    <AchievementCard title={"Self Polination " + selfCommentCount} />
                                </div>
                            </div>,
                            document.getElementById('achievementList')
                    );
                }
            };
            xhttp.open("GET", "http://api.inaturalist.org/v1/observations?user_id=henrydelange&per_page=50&order=desc&order_by=created_at", true);
            xhttp.send();
        </script>
        
        <!--Bootstrap - Must be near end of body-->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
                
<!--NOTE: When using ReactJS in Production-->
        <!--
          Note: this page is a great way to try React but it's not suitable for production.
          It slowly compiles JSX with Babel in the browser and uses a large development build of React.
    
          To set up a production-ready React build environment, follow these instructions:
          * https://reactjs.org/docs/add-react-to-a-new-app.html
          * https://reactjs.org/docs/add-react-to-an-existing-app.html
    
          You can also use React without JSX, in which case you can remove Babel:
          * https://reactjs.org/docs/react-without-jsx.html
          * https://reactjs.org/docs/cdn-links.html
        -->
    </body>
</html>